var oe=Object.defineProperty;var Me=Object.getOwnPropertyDescriptor;var Ae=Object.getOwnPropertyNames;var He=Object.prototype.hasOwnProperty;var Ie=(i,n)=>{for(var e in n)oe(i,e,{get:n[e],enumerable:!0})},Re=(i,n,e,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of Ae(n))!He.call(i,o)&&o!==e&&oe(i,o,{get:()=>n[o],enumerable:!(t=Me(n,o))||t.enumerable});return i};var De=i=>Re(oe({},"__esModule",{value:!0}),i);var Je={};Ie(Je,{default:()=>te});module.exports=De(Je);var P=require("obsidian");var T=require("obsidian");var ne=Symbol.for("v1.to-use.peak-dev.org"),re=Symbol.for("v1.factory.to-use.peak-dev.org"),I,V,g=function(){return Object.defineProperties(i(),{this:{get(){if(I)return I;throw new TypeError("No current context")}},me:{value:ne},factory:{value:re}});function i(o){let r=new Map;r.prev=o;let a=Object.assign(o?s=>{let p=r.get(s);if(!p){for(let y=r.prev;y;y=y.prev)if(p=y.get(s)){p=Object.assign(Object.assign({},p),{s:p.s||1});break}p=p||{s:2,v:e},r.set(s,p)}let f,h,m;for(;;)switch(p.s){case 0:return I===a&&V&&V.push(s),p.v;case 1:if(f=p.d,!f||c(()=>f.k.every(y=>a(y)===f.c(y)))){p.s=0;break}p.v=f.f;case 2:p.s=4;try{n(r,s,0,c(h=p.v,s,m=[])),m.length&&(p.d={c:a,f:h,k:m});break}catch(y){p.s=3,p.v=y,p.d=null}case 3:throw p.v;case 4:throw new Error(`Factory ${String(p.v)} didn't resolve ${String(s)}`)}}:s=>g.this(s),{def(s,p){return n(r,s,2,p),a},set(s,p){return n(r,s,1,p),a},fork(s){let p=i(r);return s!=null?p(s):p}});return o?a.use=a:a;function c(s,p,f){let h=I,m=V;try{return I=a,V=f,s(p)}finally{I=h,V=m}}}function n(o,r,a,c){if(o.has(r)){let s=o.get(r);if(!s.s)throw new Error(`Already read: ${String(r)}`);s.s=a,s.v=c,s.d=null}else o.set(r,{s:a,v:c})}function e(o){if(typeof o[ne]=="function")return o[ne](o);if(t(o))return typeof o.prototype[re]=="function"?o.prototype[re]():new o;throw new ReferenceError(`No config for ${String(o)}`)}function t(o){return typeof o=="function"&&o.prototype!==void 0&&(Object.getPrototypeOf(o.prototype)!==Object.prototype||Object.getOwnPropertyNames(o.prototype).length>1||o.toString().startsWith("class"))}}();var he,k=(he=window.queueMicrotask)!=null?he:(i=>n=>i.then(n))(Promise.resolve());g.def(T.Plugin,()=>{throw new Error("Plugin not created yet")});var w=class extends T.Component{constructor(){super(...arguments);this.use=g.service(this)}};g.service=function(i){return g($).addChild(i),g.this};g.plugin=function(i){let n=g.fork().set(T.Plugin,i).set(i.constructor,i);return i.addChild(n.use($)),n};var $=class extends T.Component{constructor(){super(...arguments);this.children=new Set([this])}onload(){this.loaded=!0}onunload(){this.loaded=!1,this.children.clear()}addChild(e){return this.children.has(e)||(this.children.add(e),this.loaded?k(()=>super.addChild(e)):super.addChild(e)),e}};function B(i,n){i._loaded&&i.removeChild(n)}function de(i,n){let e=new T.Component;e.onload=()=>{B(i,e),n()},i.addChild(e)}function u(i,n){let e=Object.keys(n).map(t=>Ne(i,t,n[t]));return e.length===1?e[0]:function(){e.forEach(t=>t())}}function Ne(i,n,e){let t=i[n],o=i.hasOwnProperty(n),r=e(t);return t&&Object.setPrototypeOf(r,t),Object.setPrototypeOf(a,r),i[n]=a,c;function a(...s){return r===t&&i[n]===a&&c(),r.apply(this,s)}function c(){i[n]===a&&(o?i[n]=t:delete i[n]),r!==t&&(r=t,Object.setPrototypeOf(a,t||Function))}}function U(i,n,e){return t[i]=i,t;function t(...o){return(n[i]===i?n:e).apply(this,o)}}var j=require("obsidian");var X=require("obsidian");function _(i){let n=app.workspace;switch(i==null?void 0:i.getRoot()){case n.rootSplit:case n.floatingSplit:case n.leftSplit:case n.rightSplit:return!0;default:return!1}}function M(i,n){if(!i)return!1;if(typeof i=="function"&&(n=i,i=app.workspace),n(i))return!0;if(i instanceof X.Workspace)return M(i.rootSplit,n)||M(i.floatingSplit,n)||M(i.leftSplit,n)||M(i.rightSplit,n);if(i instanceof X.WorkspaceParent){for(let e of i.children)if(M(e,n))return!0}return!1}function ie(i){return i&&typeof i=="object"?JSON.parse(JSON.stringify(i)):i}var S=class{constructor(n,e,t,o){this.key=e;this.defaultValue=t;this.owner=o;this.store=n.use(z)}of(n){return new S(this.store,this.key,this.defaultValue,n)}get(n=this.owner){return this.store.get(this.requires(n),this.key,this.defaultValue)}set(n,e=this.owner){this.store.set(this.requires(e),this.key,n)}unset(n=this.owner){this.store.unset(this.requires(n),this.key)}requires(n){if(n&&(n instanceof j.Workspace||n instanceof j.WorkspaceItem))return n;throw new TypeError("Setting method requires a workspace or workspace item")}onSet(n,e){return this.owner?this.store.onSet(this.key,(t,o,r)=>{t===this.owner&&n.call(e,o,r)}):this.store.onSet(this.key,n,e)}onLoadWorkspace(n,e){return this.store.onLoadWorkspace(n,e)}offref(n){this.store.offref(n)}},z=class extends w{constructor(){super(...arguments);this.loading=!1}get(e,t,o){var r,a;return(a=(r=e==null?void 0:e[b])==null?void 0:r[t])!=null?a:o}set(e,t,o){let r=e[b]||(e[b]={}),a=r[t];r[t]=o,!this.loading&&a!==o&&(app.workspace.trigger(me+t,e,o,a),app.workspace.requestSaveLayout())}unset(e,t){let o=e[b];o!=null&&o.hasOwnProperty(t)&&(delete o[t],this.loading||app.workspace.requestSaveLayout())}onSet(e,t,o){return app.workspace.on(me+e,t,o)}onLoadItem(e,t){return!this.loading&&app.workspace.layoutReady&&k(()=>{M(o=>{try{e.call(t)}catch(r){console.error(r)}})}),app.workspace.on(A,e,t)}onSaveItem(e,t){return app.workspace.on(ye,e,t)}onLoadWorkspace(e,t){return!this.loading&&app.workspace.layoutReady&&k(()=>{try{e.call(t)}catch(o){console.error(o)}}),app.workspace.on(A+":workspace",e,t)}offref(e){app.workspace.offref(e)}onload(){let e=app.workspace;this.registerEvent(e.on(A+":start",()=>this.loading=!0)),this.registerEvent(e.on(A+":workspace",()=>this.loading=!1)),this.register(u(j.WorkspaceItem.prototype,{serialize:ge})),this.register(u(app.workspace,{getLayout:ge,setLayout(t){return U(ae,t,async function(r,...a){e.trigger(A+":start");try{return we(this,r),await t.call(this,r,...a)}finally{e.trigger(A+":workspace")}})},deserializeLayout(t){return U(ae,t,async function(r,...a){let c=await t.call(this,r,...a);return we(c,r),c})}}))}},se=2,ae=Symbol.for(`v${se}.layout-storage-events.ophidian.peak-dev.org`),b="ophidian:layout-settings",A=`ophidian-layout-storage:v${se}:item-load`,ye=`ophidian-layout-storage:v${se}:item-save`,me="ophidian-layout-storage:set:";function ge(i){return U(ae,i,function(){let e=i.call(this);return app.workspace.trigger(ye,this,e),this[b]&&(e[b]=ie(this[b])),e})}function we(i,n){if(!i)return;let e=n==null?void 0:n[b];e&&(i[b]=ie(e)),app.workspace.trigger(A,i,n)}var ve=require("obsidian");var R=class extends ve.Component{constructor(e,t){super();this.use=e;this.container=t;this.win=this.container.win}[g.factory](){return new J(this.constructor)}static onload(e){}static onunload(e){}},J=class extends w{constructor(e){super();this.factory=e;this.instances=new Map;this.watching=!1;this.layoutReadyCallbacks=[]}onload(){var e,t;this.registerEvent(app.workspace.on("layout-change",()=>{app.workspace.layoutReady&&this.layoutReadyCallbacks.length&&(this.layoutReadyCallbacks.forEach(k),this.layoutReadyCallbacks=[])})),(t=(e=this.factory).onload)==null||t.call(e,this.use)}onLeafChange(e,t){return this.onLayoutReady(()=>e.call(t,app.workspace.activeLeaf)),app.workspace.on("active-leaf-change",o=>{app.workspace.layoutReady&&e.call(t,o)})}onLayoutReady(e){app.workspace.layoutReady?k(e):this.layoutReadyCallbacks.push(e)}onunload(){var e,t;(t=(e=this.factory).onunload)==null||t.call(e,this.use)}watch(){if(!this._loaded)de(this,()=>this.watch());else if(!this.watching){let{workspace:e}=app,t=this;this.watching=!0,this.registerEvent(e.on("window-open",o=>{this.onLayoutReady(()=>this.forContainer(o))})),this.register(u(e,{clearLayout(o){return async function(){try{return await o.call(this)}finally{t.onLayoutReady(()=>t.forAll())}}}})),this.onLayoutReady(()=>this.forAll())}return this}forWindow(e=(o=>(o=window.activeWindow)!=null?o:window)(),t=!0){let r=Oe(e);if(r)return this.forContainer(r,t)}forContainer(e,t=!0){e=e.getContainer();let o=this.instances.get(e);return!o&&t&&(o=new this.factory(this.use,e),o&&(this.instances.set(e,o),this.addChild(o),e.component.addChild(o),o.register(()=>{B(this,o),B(e.component,o),this.instances.delete(e)}))),o}forDom(e,t=!0){return this.forWindow(Fe(e),t)}forLeaf(e=app.workspace.activeLeaf,t=!0){if(_(e))return this.forContainer(e.getContainer(),t)}forView(e,t=!0){return this.forLeaf(e.leaf,t)}forAll(e=!0){return ke().map(t=>this.forContainer(t,e)).filter(t=>t)}};function ke(){return[app.workspace.rootSplit].concat(app.workspace.floatingSplit.children)}function ce(){return ke().map(i=>i.win)}function v(){var i,n;return 1+((n=(i=app.workspace.floatingSplit)==null?void 0:i.children.length)!=null?n:0)}function Le(i){for(let n of ce())if(n.event&&i(n,n.event))return n.event}function Fe(i){return i.win||(i.ownerDocument||i).defaultView||window}function Oe(i){if(i===window)return app.workspace.rootSplit;let{floatingSplit:n}=app.workspace;if(n){for(let e of n.children)if(i===e.win)return e}}var be=require("obsidian"),G=class extends w{onload(){let n=this,e=this.use(be.Plugin);this.register(u(e,{loadCSS(t){return async function(){await t.call(this),n.triggerReparse(),this.register(()=>n.triggerReparse())}}}))}triggerReparse(){app.workspace.layoutReady&&app.workspace.trigger("parse-style-settings")}};function H(i,n,e){let t=i.classList.contains(n);return e=e!=null?e:!t,e!==t&&(e?i.classList.add(n):i.classList.remove(n)),e}var Ee={};function Se(i,n,e=[],t={}){typeof e=="string"&&(e=[e]),typeof e=="object"&&e.key&&(e=[e]);let o=e.map(function(a){if(typeof a=="object")return a;let c=a.split("+");return{modifiers:c,key:c.pop()||"+"}});Object.assign(t,{id:i,name:n,hotkeys:o});let r=Symbol("cmd:"+i);return Ee[r]=t,r}function xe(i,n=i.constructor.prototype){Object.getOwnPropertySymbols(n).forEach(e=>{let t=Ee[e],o=n[e];t&&i.addCommand(Object.assign({},t,{checkCallback(r){let a=o.call(i);return r||typeof a!="function"?!!a:(a(),!0)}}))})}var Ve=require("obsidian");var Ce={};function l(i,n,e=[],t={}){typeof e=="string"&&(e=[e]),typeof e=="object"&&e.key&&(e=[e]);let o=e.map(function(a){if(typeof a=="object")return a;let c=a.split("+");return{modifiers:c,key:c.pop()||"+"}});Object.assign(t,{id:i,name:n,hotkeys:o});let r=Symbol("cmd:"+i);return Ce[r]=t,r}function Y(i,n=i.constructor.prototype){Object.getOwnPropertySymbols(n).forEach(e=>{let t=Ce[e],o=n[e];t&&i.addCommand(Object.assign({},t,{checkCallback(r){let a=o.call(i);return r||typeof a!="function"?!!a:(a(),!0)}}))})}var W=require("obsidian");var L=require("obsidian");var E=require("obsidian");var x="pane-relief:history-v1",pe="pane-relief:history-v1",le=new WeakMap,K=class{constructor(n){this.setState(n)}get viewState(){return JSON.parse(this.raw.state||"{}")}setState(n){var e;this.raw=n,this.eState=JSON.parse(n.eState||"null"),this.path=(e=this.viewState.state)==null?void 0:e.file}onRename(n,e){if(this.path===e){let t=this.viewState;this.path=t.state.file=n.path,this.raw.state=JSON.stringify(t)}}go(n){let{viewState:e,path:t,eState:o}=this,r=t&&(app==null?void 0:app.vault.getAbstractFileByPath(t));t&&!r&&(new E.Notice("Missing file: "+t),e={type:"empty",state:{}},o=void 0),n.setViewState({...e,active:!0,popstate:!0},o)}isEmpty(){return JSON.parse(this.raw.state||"{}").type==="empty"}replaceState(n){var e;if(n.state!==this.raw.state){let t=JSON.parse(n.state||"{}");if(t.type==="empty")return!0;if(this.path&&this.path!==((e=t==null?void 0:t.state)==null?void 0:e.file))return!1;if(t.type==="media-view"){let o=JSON.stringify(this.viewState.state.info),r=JSON.stringify(t.state.info);if(o!==r)return!1}}return this.setState(n),!0}},d=class{constructor(n,{pos:e,stack:t}={pos:0,stack:[]}){this.leaf=n;this.leaf=n,this.pos=e,this.stack=t.map(o=>new K(o))}static current(){return this.forLeaf(app.workspace.activeLeaf)||new this}static forLeaf(n){var e;if(n&&le.set(n.containerEl,n),n)return n[x]instanceof this?n[x]:n[x]=new this(n,((e=n[x])==null?void 0:e.serialize())||void 0)}cloneTo(n){return n[x]=new d(n,this.serialize())}onRename(n,e){for(let t of this.stack)t.onRename(n,e)}serialize(){return{pos:this.pos,stack:this.stack.map(n=>n.raw)}}get state(){var n;return((n=this.stack[this.pos])==null?void 0:n.raw)||null}get length(){return this.stack.length}back(){this.go(-1)}forward(){this.go(1)}lookAhead(){return this.stack.slice(0,this.pos).reverse()}lookBehind(){return this.stack.slice(this.pos+1)}announce(){var n;(n=app==null?void 0:app.workspace)==null||n.trigger("pane-relief:update-history",this.leaf,this)}goto(n){var e;if(!!this.leaf){if(this.leaf.pinned)return new E.Notice("Pinned pane: unpin before going forward or back"),void 0;if(this.leaf.working)return new E.Notice("Pane is busy: please wait before navigating further"),void 0;n=this.pos=Math.max(0,Math.min(n,this.stack.length-1)),(e=this.stack[n])==null||e.go(this.leaf),this.announce()}}go(n,e){if(!this.leaf||!n)return;let t=Math.max(0,Math.min(this.pos-n,this.stack.length-1));e||t!==this.pos?this.goto(t):new E.Notice(`No more ${n<0?"back":"forward"} history for pane`)}replaceState(n,e,t){let o=this.stack[this.pos];o?o.replaceState(n)||this.pushState(n,e,t):this.stack[this.pos]=new K(n)}pushState(n,e,t){let o=this.stack[this.pos];if(o&&o.isEmpty())return this.replaceState(n,e,t);for(this.stack.splice(0,this.pos,new K(n)),this.pos=0;this.stack.length>20;)this.stack.pop();this.announce()}},Q=class extends w{onload(){let n=this.use(z);this.registerEvent(n.onSaveItem((o,r)=>{o instanceof E.WorkspaceLeaf&&o[x]&&(r[pe]=o[x].serialize())})),this.registerEvent(n.onLoadItem((o,r)=>{o instanceof E.WorkspaceLeaf&&r[pe]&&(o[x]=new d(o,r[pe]))})),this.register(u(E.WorkspaceLeaf.prototype,{setViewState(o){return function(a,c){var s;return a.popstate&&((s=window.event)==null?void 0:s.type)==="popstate"?Promise.resolve():o.call(this,a,c)}}})),this.register(u(app.workspace,{setActiveLeaf(o){return function(a,...c){let s=u(this,{recordHistory(p){return function(f,h,...m){return p.call(this,f,!1,...m)}}});try{return o.call(this,a,...c)}finally{s()}}}}));function e(o){return!!Le((r,a)=>{if(a.type==="mousedown"&&a.button===o)return a.preventDefault(),a.stopImmediatePropagation(),!0})}let t=window.history;this.register(()=>window.history=t),Object.defineProperty(window,"history",{enumerable:!0,configurable:!0,writable:!0,value:{get state(){return d.current().state},get length(){return d.current().length},back(){e(3)||this.go(-1)},forward(){e(4)||this.go(1)},go(o){d.current().go(o)},replaceState(o,r,a){d.current().replaceState(o,r,a)},pushState(o,r,a){d.current().pushState(o,r,a)},get scrollRestoration(){return t.scrollRestoration},set scrollRestoration(o){t.scrollRestoration=o}}})}};var ze={markdown:"document",image:"image-file",audio:"audio-file",video:"audio-file",pdf:"pdf-file",localgraph:"dot-network",outline:"bullet-list",backlink:"link",kanban:"blocks",excalidraw:"excalidraw-icon","media-view":"audio-file"},We={graph:["dot-network","Graph View"],"file-explorer":["folder","File Explorer"],starred:["star","Starred Files"],tag:["tag","Tags View"],"recent-files":["clock","Recent Files"],calendar:["calendar-with-checkmark","Calendar"],empty:["cross","No file"]},D=class extends R{constructor(){super(...arguments);this.historyIsOpen=!1}display(e=this.latestLeaf()){if(!this.historyIsOpen){if(!this._loaded){this.load();return}this.win.requestAnimationFrame(()=>{let t=e?d.forLeaf(e):new d;this.back.setHistory(t),this.forward.setHistory(t),e&&this.updateLeaf(e,t)})}}leaves(){var r;let e=new Set,t=a=>{e.add(a)};app.workspace.iterateLeaves(t,this.container);let o=(r=app.plugins.plugins["obsidian-hover-editor"])==null?void 0:r.activePopovers;if(o)for(let a of o)a.hoverEl.ownerDocument.defaultView===this.win&&(a.rootSplit?app.workspace.iterateLeaves(t,a.rootSplit):a.leaf&&t(a.leaf));return[...e.values()]}latestLeaf(){let e=app.workspace.activeLeaf;return e&&this.use(D).forLeaf(e)===this?e:this.leaves().reduce((t,o)=>!t||t.activeTime<o.activeTime?o:t,null)}onload(){let{document:e}=this.win;(0,L.requireApiVersion)("0.16.0")&&e.body.addClass("obsidian-themepocalypse"),e.addEventListener("mouseup",t,!0),e.addEventListener("mousedown",t,!0),this.register(()=>{e.removeEventListener("mouseup",t,!0),e.removeEventListener("mousedown",t,!0)});function t(o){if(o.button!==3&&o.button!==4)return;o.preventDefault(),o.stopPropagation();let r=o.target.matchParent(".workspace-leaf");if(r&&o.type==="mouseup"){let a=le.get(r);if(a||app.workspace.iterateAllLeaves(c=>a=c.containerEl===r?c:a),!a)return!1;o.button==3&&d.forLeaf(a).back(),o.button==4&&d.forLeaf(a).forward()}return!1}app.workspace.onLayoutReady(()=>{this.addChild(this.back=new C(this,"back",-1)),this.addChild(this.forward=new C(this,"forward",1)),this.display(),this.numberPanes(),this.registerEvent(app.workspace.on("layout-change",this.numberPanes,this))})}onunload(){this.unNumberPanes(),this.win.document.body.findAll(".workspace-leaf").forEach(e=>{let t=e.find(".view-header > .view-actions"),o=t==null?void 0:t.find('.view-action[class*=" app:go-forward"]'),r=t==null?void 0:t.find('.view-action[class*=" app:go-back"]');o&&N(o,this.forward.oldLabel),r&&N(o,this.back.oldLabel)})}unNumberPanes(e=".workspace-leaf"){this.win.document.body.findAll(e).forEach(t=>{t.style.removeProperty("--pane-relief-label"),t.toggleClass("has-pane-relief-label",!1),t.style.removeProperty("--pane-relief-forward-count"),t.style.removeProperty("--pane-relief-backward-count")})}updateLeaf(e,t=d.forLeaf(e)){e.containerEl.style.setProperty("--pane-relief-forward-count",'"'+(t.lookAhead().length||"")+'"'),e.containerEl.style.setProperty("--pane-relief-backward-count",'"'+(t.lookBehind().length||"")+'"');let o=e.containerEl.find(".view-header > .view-actions"),r=o==null?void 0:o.find('.view-action[class*=" app:go-forward"]'),a=o==null?void 0:o.find('.view-action[class*=" app:go-back"]');r&&this.forward.updateDisplay(t,r),a&&this.back.updateDisplay(t,a)}numberPanes(){this.win.requestAnimationFrame(()=>{this.win===window&&this.unNumberPanes(".workspace-tabs > .workspace-leaf");let e=0,t=null;this.leaves().forEach(o=>{o.containerEl.style.setProperty("--pane-relief-label",++e<9?""+e:""),o.containerEl.toggleClass("has-pane-relief-label",e<9),t=o,this.updateLeaf(o)}),e>8&&(t==null||t.containerEl.style.setProperty("--pane-relief-label","9"),t==null||t.containerEl.toggleClass("has-pane-relief-label",!0))})}onUpdateHistory(e,t){this.win.requestAnimationFrame(()=>{this.updateLeaf(e),t===this.forward.history&&this.forward.setHistory(t),t===this.back.history&&this.back.setHistory(t)})}},fe=class extends L.Component{constructor(e,t,o){super();this.owner=e;this.kind=t;this.dir=o;this.history=null}onload(){this.containerEl=this.owner.win.document.body.find(`.titlebar .titlebar-button-container.mod-left .titlebar-button.mod-${this.kind}`)||this.owner.win.createDiv(),this.count=this.containerEl.createSpan({prepend:this.kind==="back",cls:"history-counter"}),this.history=null,this.oldLabel=this.containerEl.getAttribute("aria-label"),this.registerDomEvent(this.containerEl,"contextmenu",this.openMenu.bind(this));let e=t=>{var o;t.preventDefault(),t.stopImmediatePropagation(),(o=this.history)==null||o[this.kind]()};this.register(()=>this.containerEl.removeEventListener("click",e,!0)),this.containerEl.addEventListener("click",e,!0),this.register(je(this.owner.win.document.body,"contextmenu",`.view-header > .view-actions > .view-action[class*="app:go-${this.kind}"]`,(t,o)=>{let r=o.matchParent(".workspace-leaf"),a=this.owner.leaves().filter(c=>c.containerEl===r).pop();!a||(t.preventDefault(),t.stopImmediatePropagation(),this.openMenu(t,d.forLeaf(a)))},{capture:!0}))}onunload(){N(this.containerEl,this.oldLabel),this.count.detach(),this.containerEl.toggleClass("mod-active",!1)}setCount(e){this.count.textContent=""+(e||"")}setHistory(e=d.current()){this.updateDisplay(this.history=e)}updateDisplay(e,t=this.containerEl){let o=e[this.dir<0?"lookBehind":"lookAhead"]();t===this.containerEl&&this.setCount(o.length),N(t,o.length?this.oldLabel+`
`+this.formatState(o[0]).title:`No ${this.kind} history`),t.toggleClass("mod-active",o.length>0)}openMenu(e,t=this.history){var a;let o=t[this.dir<0?"lookBehind":"lookAhead"]();if(!o.length)return;let r=new L.Menu;(a=r.setUseNativeMenu)==null||a.call(r,!1),r.dom.addClass("pane-relief-history-menu"),r.dom.on("mousedown",".menu-item",c=>{c.stopPropagation()},!0),o.map(this.formatState.bind(this)).forEach((c,s)=>this.menuItem(c,s,r,t)),r.showAtPosition({x:e.clientX,y:e.clientY+20}),this.owner.historyIsOpen=!0,r.onHide(()=>{this.owner.historyIsOpen=!1,this.owner.display()})}menuItem(e,t,o,r){let{dir:a,kind:c}=this;o.addItem(f=>{s(f),e.file&&p(f.dom)});return;function s(f,h=""){f.setIcon(e.icon).setTitle(h+e.title).onClick(m=>{L.Keymap.isModEvent(m)&&(r=r.cloneTo(app.workspace.splitActiveLeaf())),r.go((t+1)*a,!0)})}function p(f){f.addEventListener("mouseover",h=>{app.workspace.trigger("hover-link",{event:h,source:fe.hoverSource,hoverParent:o.dom,targetEl:f,linktext:e.file.path})}),f.setAttr("draggable","true"),f.addEventListener("dragstart",h=>{let m=app.dragManager,y=m.dragFile(h,e.file);m.onDragStart(h,y)}),f.addEventListener("dragend",h=>o.hide()),f.addEventListener("contextmenu",h=>{let m=new L.Menu;m.addItem(y=>s(y,`Go ${c} to `)).addSeparator(),app.workspace.trigger("file-menu",m,e.file,"link-context-menu"),m.showAtPosition({x:h.clientX,y:h.clientY}),h.stopPropagation()},!0)}}formatState(e){var p,f,h;let{viewState:{type:t,state:o},eState:r,path:a}=e,c=a&&app.vault.getAbstractFileByPath(a),s={icon:"",title:"",file:c,type:t,state:o,eState:r};return We[t]?[s.icon,s.title]=We[t]:a&&!c?[s.icon,s.title]=["trash","Missing file "+a]:c instanceof L.TFile&&(s.icon=(p=ze[t])!=null?p:"document",t==="markdown"&&o.mode==="preview"&&(s.icon="lines-of-text"),s.title=c?c.basename+(c.extension!=="md"?"."+c.extension:""):"No file",t==="media-view"&&!c&&(s.title=(h=(f=o.info)==null?void 0:f.filename)!=null?h:s.title)),app.workspace.trigger("pane-relief:format-history-item",s),s}},C=fe;C.hoverSource="pane-relief:history-menu";function je(i,n,e,t,o){return i.on(n,e,t,o),()=>i.off(n,e,t,o)}function N(i,n){n?i.setAttribute("aria-label",n||void 0):i.removeAttribute("aria-label")}var Z=class extends w{constructor(){super(...arguments);this.setting=new S(this,"pane-relief:focus-lock").of(app.workspace);this.plugin=this.use(W.Plugin);this.statusEl=this.plugin.addStatusBarItem();this.iconEl=this.statusEl.createSpan("pane-relief-focus-lock icon",e=>{e.setAttribute("aria-label-position","top")});this.isLocked=null;this.installed=!1}onload(){this.registerDomEvent(this.iconEl,"click",()=>this.toggle()),Y(this.plugin,{[l("focus-lock","Toggle focus lock (Enable/disable sidebar focusing)")]:()=>()=>this.toggle()}),this.registerEvent(this.setting.onLoadWorkspace(this.onChange,this))}install(){this.installed=!0;let e=this;this.register(u(app.workspace,{setActiveLeaf(t){return function(o,r,a){if(!e.isLocked||q(o))return t.call(this,o,r,a);if(!this.activeLeaf||!_(this.activeLeaf))return t.call(this,this.getLeaf(),r,a)}},revealLeaf(t){return function(o){let r=o.getContainer();if(!e.isLocked||q(o)||!r)return t.call(this,o);let a=u(r,{focus(){return function(){}}});try{return t.call(this,o)}finally{a()}}}})),this.register(u(W.WorkspaceLeaf.prototype,{canNavigate(t){return function(){return t.call(this)&&(!e.isLocked||q(this))}}})),this.register(u(app.internalPlugins.plugins["file-explorer"].instance,{init(t){return function(...r){try{return t.apply(this,r)}finally{e.blockFileExplorerReveal()}}}})),this.blockFileExplorerReveal()}blockFileExplorerReveal(){let e=this,t=app.commands.commands["file-explorer:reveal-active-file"];t&&this.register(u(t,{checkCallback(o){return function(...r){var a;if(e.isLocked){for(let c of app.workspace.getLeavesOfType("file-explorer"))if(!q(c)){let s=(a=c.view.dom)==null?void 0:a.navFileContainerEl;s&&k(u(s,{focus(p){return function(){}}}))}}return o==null?void 0:o.apply(this,r)}}}))}toggle(){this.setting.set(!this.setting.get()),this.onChange()}onChange(){let e=this.setting.get();e&&!this.installed&&this.install(),this.isLocked!==e&&(this.isLocked!=null&&document.body.appendChild(new W.Notice(e?"Sidebar focusing disabled":"Sidebar focusing enabled").noticeEl.parentElement),this.isLocked=e,(0,W.setIcon)(this.iconEl,e?"lucide-lock":"lucide-unlock",13),N(this.iconEl,e?"Sidebar focus disabled: click to enable":"Sidebar focus enabled: click to disable"),e&&!q(app.workspace.activeLeaf)&&app.workspace.layoutReady&&app.workspace.setActiveLeaf(app.workspace.getUnpinnedLeaf(),!1,!0))}};function q(i){let n=i==null?void 0:i.getRoot();return!!(n&&n!==app.workspace.leftSplit&&n!==app.workspace.rightSplit)}var Pe=require("obsidian"),ee=class extends w{constructor(){super(...arguments);this.fixSlidingPanes=(0,Pe.debounce)(()=>{app.workspace.requestActiveLeafEvents()},5)}onload(){this.registerEvent(app.workspace.on("layout-change",()=>{for(let t of this.parents())this.refresh(t)}));let e=this;this.register(u(app.workspace,{setActiveLeaf(t){return function(r,a,c){let s=e.parentForLeaf(r),p=e.parentForLeaf(app.workspace.activeLeaf);return s&&p&&s!==p&&p.matchParent(".hover-popover.is-active.snap-to-viewport")&&s.ownerDocument===p.ownerDocument&&!s.matchParent(".hover-popover")&&app.commands.executeCommandById("obsidian-hover-editor:restore-active-popover"),s&&e.refresh(s,s.hasClass("should-maximize")?r.containerEl:null),t.call(this,r,a,c)}}}))}onunload(){for(let e of this.parents())this.refresh(e,null)}toggleMaximize(e=app.workspace.activeLeaf){let t=this.parentForLeaf(e);if(!t)return;let o=t.matchParent(".hover-popover");if(o&&app.plugins.plugins["obsidian-hover-editor"]&&o.findAll(".workspace-leaf").length===1){app.commands.executeCommandById("obsidian-hover-editor:"+(o.hasClass("snap-to-viewport")?"restore-active-popover":"snap-active-popover-to-viewport"));return}t&&this.refresh(t,H(t,"should-maximize")?e.containerEl:null)}lastMaximized(e){return e.find(".workspace-leaf.is-maximized")||app.workspace.getMostRecentLeaf().containerEl}refresh(e,t=e.hasClass("should-maximize")?this.lastMaximized(e):null){let o=e.hasClass("has-maximized");e.findAllSelf(".workspace-split, .workspace-tabs").forEach(r=>{(r===e||this.parentFor(r)===e)&&H(r,"has-maximized",t?r.contains(t):!1)}),e.findAll(".workspace-leaf").forEach(r=>{this.parentFor(r)===e&&H(r,"is-maximized",r===t)}),(!t||!e.contains(t))&&(H(e,"should-maximize",!1),o&&this.fixSlidingPanes())}parents(){var o,r,a;let e=[app.workspace.rootSplit.containerEl];e.concat(((r=(o=app.workspace.floatingSplit)==null?void 0:o.children)!=null?r:[]).map(c=>c.containerEl));let t=(a=app.plugins.plugins["obsidian-hover-editor"])==null?void 0:a.activePopovers;if(t)for(let c of t)c.rootSplit&&e.push(c.rootSplit.containerEl);return e}parentForLeaf(e){return this.parentFor(e==null?void 0:e.containerEl)}parentFor(e){return e==null?void 0:e.matchParent(".workspace-split.mod-root, .hover-popover > .popover-content > .workspace-split")}};var O=require("obsidian"),F=class extends R{constructor(){super(...arguments);this.manager=this.use(F)}[g.factory](){return new ue(this.constructor)}onload(){this.onSet()}onunload(){this.update(!1)}get options(){return this.manager.options.get(this.container)}set options(e){this.manager.options.set(e,this.container)}onSet(e=this.options){this.update(e.active)}update(e){H(this.container.containerEl,"is-sliding",e)}activate(e){var o;let{options:t}=this;!this.win.document.hasFocus()&&ce().some(r=>r.document.hasFocus())&&this.container.focus(),t.active&&((o=e.containerEl.matchParent(".workspace-tabs"))!=null?o:e.containerEl).scrollIntoView({behavior:"smooth"}),this.manager.options.defaultValue=t}toggleSliding(){let{options:e}=this;this.options={...e,active:!e.active}}},ue=class extends J{constructor(){super(...arguments);this.options=new S(this,"pane-relief:sliding-panes",{active:!1})}onload(){super.onload(),window.CodeMirror.getMode({},"XXX");let e=this;xe(this.use(O.Plugin),{[Se("toggle-sliding","Toggle sliding panes (for current window)")](){return()=>e.forLeaf(app.workspace.activeLeaf).toggleSliding()}}),this.registerEvent(this.options.onSet(this.onChange,this)),this.registerEvent(this.options.store.onLoadItem(this.onChange,this)),this.registerEvent(this.onLeafChange(t=>this.forLeaf(t).activate(t)))}onChange(e){(e instanceof O.WorkspaceRoot||e instanceof O.WorkspaceWindow)&&this.forContainer(e).onSet(this.options.get(e))}};var te=class extends P.Plugin{constructor(){super(...arguments);this.use=g.plugin(this);this.nav=this.use(D).watch();this.max=this.use(ee);this.sliding=this.use(F).watch()}onload(){this.use(Q).load(),this.register(u(P.Workspace.prototype,{getFocusedContainer(e){return function(){let o=e.call(this);return o===this.rootSplit&&window!==activeWindow?null:o}}})),this.app.workspace.registerHoverLinkSource(C.hoverSource,{display:"History dropdowns",defaultMod:!0}),this.app.workspace.onLayoutReady(()=>{this.registerEvent(this.app.vault.on("rename",(e,t)=>{e instanceof P.TFile&&this.app.workspace.iterateAllLeaves(o=>d.forLeaf(o).onRename(e,t))})),this.registerEvent(app.workspace.on("active-leaf-change",e=>this.nav.forLeaf(e).display(e))),this.registerEvent(app.workspace.on("pane-relief:update-history",(e,t)=>this.nav.forLeaf(e).onUpdateHistory(e,t)))}),Y(this),(0,P.requireApiVersion)("0.15.6")&&this.use(Z),this.use(G)}[l("swap-prev","Swap pane with previous in split","Mod+Shift+PageUp")](){return this.leafPlacer(-1)}[l("swap-next","Swap pane with next in split","Mod+Shift+PageDown")](){return this.leafPlacer(1)}[l("go-prev","Cycle to previous workspace pane","Mod+PageUp")](){return()=>this.gotoNthLeaf(-1,!0)}[l("go-next","Cycle to next workspace pane","Mod+PageDown")](){return()=>this.gotoNthLeaf(1,!0)}[l("win-prev","Cycle to previous window",[])](){if(v()>1)return()=>this.gotoNthWindow(-1,!0)}[l("win-next","Cycle to next window",[])](){if(v()>1)return()=>this.gotoNthWindow(1,!0)}[l("go-1st","Jump to 1st pane in the workspace","Alt+1")](){return()=>this.gotoNthLeaf(0)}[l("go-2nd","Jump to 2nd pane in the workspace","Alt+2")](){return()=>this.gotoNthLeaf(1)}[l("go-3rd","Jump to 3rd pane in the workspace","Alt+3")](){return()=>this.gotoNthLeaf(2)}[l("go-4th","Jump to 4th pane in the workspace","Alt+4")](){return()=>this.gotoNthLeaf(3)}[l("go-5th","Jump to 5th pane in the workspace","Alt+5")](){return()=>this.gotoNthLeaf(4)}[l("go-6th","Jump to 6th pane in the workspace","Alt+6")](){return()=>this.gotoNthLeaf(5)}[l("go-7th","Jump to 7th pane in the workspace","Alt+7")](){return()=>this.gotoNthLeaf(6)}[l("go-8th","Jump to 8th pane in the workspace","Alt+8")](){return()=>this.gotoNthLeaf(7)}[l("go-last","Jump to last pane in the workspace","Alt+9")](){return()=>this.gotoNthLeaf(99999999)}[l("win-1st","Switch to 1st window",[])](){if(v()>1)return()=>this.gotoNthWindow(0)}[l("win-2nd","Switch to 2nd window",[])](){if(v()>1)return()=>this.gotoNthWindow(1)}[l("win-3rd","Switch to 3rd window",[])](){if(v()>2)return()=>this.gotoNthWindow(2)}[l("win-4th","Switch to 4th window",[])](){if(v()>3)return()=>this.gotoNthWindow(3)}[l("win-5th","Switch to 5th window",[])](){if(v()>4)return()=>this.gotoNthWindow(4)}[l("win-6th","Switch to 6th window",[])](){if(v()>5)return()=>this.gotoNthWindow(5)}[l("win-7th","Switch to 7th window",[])](){if(v()>6)return()=>this.gotoNthWindow(6)}[l("win-8th","Switch to 8th window",[])](){if(v()>7)return()=>this.gotoNthWindow(7)}[l("win-last","Switch to last window",[])](){if(v()>1)return()=>this.gotoNthWindow(99999999)}[l("put-1st","Place as 1st pane in the split","Mod+Alt+1")](){return()=>this.placeLeaf(0,!1)}[l("put-2nd","Place as 2nd pane in the split","Mod+Alt+2")](){return()=>this.placeLeaf(1,!1)}[l("put-3rd","Place as 3rd pane in the split","Mod+Alt+3")](){return()=>this.placeLeaf(2,!1)}[l("put-4th","Place as 4th pane in the split","Mod+Alt+4")](){return()=>this.placeLeaf(3,!1)}[l("put-5th","Place as 5th pane in the split","Mod+Alt+5")](){return()=>this.placeLeaf(4,!1)}[l("put-6th","Place as 6th pane in the split","Mod+Alt+6")](){return()=>this.placeLeaf(5,!1)}[l("put-7th","Place as 7th pane in the split","Mod+Alt+7")](){return()=>this.placeLeaf(6,!1)}[l("put-8th","Place as 8th pane in the split","Mod+Alt+8")](){return()=>this.placeLeaf(7,!1)}[l("put-last","Place as last pane in the split","Mod+Alt+9")](){return()=>this.placeLeaf(99999999,!1)}[l("maximize","Maximize active pane (Toggle)",[])](){if(this.max.parentForLeaf(app.workspace.activeLeaf))return()=>this.max.toggleMaximize()}[l("ordered-close","Close pane and go to adjacent pane")](){return()=>{let e=app.workspace.activeLeaf,t=this.nav.forLeaf(e).leaves(),o=t.indexOf(e),r;o>-1&&(t.length>o+1?r=t[o+1]:o>0&&(r=t[o-1])),r&&app.workspace.setActiveLeaf(r,!1,!0),e.detach()}}[l("open-new-window","Open new window")](){return()=>app.workspace.openPopoutLeaf()}onunload(){this.app.workspace.unregisterHoverLinkSource(C.hoverSource)}gotoNthLeaf(e,t){let o=app.workspace.activeLeaf,r=o.getRoot();(r===app.workspace.leftSplit||r===app.workspace.rightSplit)&&(o=app.workspace.getMostRecentLeaf(app.workspace.rootSplit));let a=this.nav.forLeaf(o);o=Te(a.leaves(),o,e,t),!o||this.app.workspace.setActiveLeaf(o,!0,!0)}gotoNthWindow(e,t){var a,c,s,p,f;let o=Te(this.nav.forAll(),this.nav.forLeaf(app.workspace.activeLeaf),e,t),r=o==null?void 0:o.latestLeaf();r&&app.workspace.setActiveLeaf(r,!0,!0),(f=(p=(s=(c=(a=o==null?void 0:o.win).require)==null?void 0:c.call(a,"electron"))==null?void 0:s.remote)==null?void 0:p.getCurrentWindow())==null||f.focus()}placeLeaf(e,t=!0){let o=this.leafPlacer(e,t);o&&o()}leafPlacer(e,t=!0){let o=this.app.workspace.activeLeaf;if(!o)return!1;let r=o.parentSplit,a=r.children,c=a.indexOf(o);if(c==-1)return!1;if(a.length===1){let s=o.containerEl.matchParent(".hover-popover");if(s&&t&&Math.abs(e)===1){let p=s;for(;p&&(p===s||!p.matches(".hover-popover"));)p=e<0?p.previousElementSibling:p.nextElementSibling;if(p)return()=>{e<0?p.parentElement.insertBefore(s,p):p.parentElement.insertBefore(p,s),app.workspace.onLayoutChange()}}}if(t){if(e+=c,e<0||e>=a.length)return!1}else e>=a.length&&(e=a.length-1),e<0&&(e=0);return c==e?!1:()=>{let s=a[e];a.splice(c,1),a.splice(e,0,o),r.selectTab?r.selectTab(o):(s.containerEl.insertAdjacentElement(c>e?"beforebegin":"afterend",o.containerEl),r.recomputeChildrenDimensions(),o.onResize(),this.app.workspace.onLayoutChange(),this.app.workspace.activeLeaf=null,this.app.workspace.setActiveLeaf(o,!1,!0))}}};function Te(i,n,e,t){return t&&(e+=i.indexOf(n),e=(e+i.length)%i.length),i[e>=i.length?i.length-1:e]}
